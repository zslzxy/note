# Linux学习笔记

[TOC]

## 1. Linux 分区

### 1.1 磁盘分区

- **MBR分区表**：主引导记录分区表，最大支持2.1TB硬盘，最多支持四个分区。
- **GPT分区表**：全局唯一标识分区表，支持9.4ZB硬盘，理论上支持分区数量无限制，但是windows中限制128个分区。

### 1.2 格式化

> ​	格式化又称为逻辑格式化，它指的是根据用户选定的文件系统（如：FAT16、FAT32、NTFS、EXT2、EXT3、EXT4等），在磁盘的特定区域写入特定数据，在分区中划出一片用于存放文件分配表、目录表等用于文件管理的磁盘空间。

​	格式化主要的作用就是  **为了写入文件系统**。

## 2 基本配置

### 2.1 配置网卡

1. 安装 vim ： **yum install vim -y**

2. 修改文件： **vim /etc/sysconfig/network-scripts/ifcfg-eth0**

3. 配置文件内容：

   ```shell
   ONBOOT=yes
   BOOTPROTO=static
   DNS=192.168.21.2
   GATEWAY=192.168.21.2
   IPADDR=193.168.21.191
   ```

4.  重新启动Network：**service network restart**

### 2.2 日志介绍

​	在**~**目录中，存在对应的三个log日志文件：

- anaconda-ks.cfg：记录的是图形化安装操作系统的步骤数据，主要**用于服务器批量安装**。
- install.log ： 记录的是安装过的软件安装包的名称，主要是用于记录安装的软件名称。
- install.log.syslog：记录操作的事件的日志，主要是用于记录对用户等操作的记录。

### 2.3 注意事项

- Linux严格区分大小写。
- Linux 中一切皆文件。
- Linux中不能使用扩展名来进行文件类型区分。
- 针对压缩包的命名方式，需要按照不同的压缩规则进行命名，避免不知道什么压缩命令。
- 二进制软件包，也就是.RPM包，通常是需要使用 .rpm 后缀来进行命名。
- Shell脚本文件，一般采用的是 .sh 结尾。
- Linux操作系统远程操作，只能重启，不能关机。服务器远程控制，关机以后可能开机很麻烦。
- 服务器重新启动之前，需要注意事项：
  - 终止正在执行的服务。其主要原因是为了避免出现系统硬件、数据异常。
  - 尽量使用  shutdown 命令执行关机执行令。
  - 尽量在开机之前多执行几次 sync 命令，保证程序的数据的同步。

### 2.4 目录结构

#### 2.4.1 一级目录

- **`/bin`**  存放系统命令的目录，普通用户和超级用户都可以执行。也是 /usr/bin 目录的软连接。
- **`/sbin`** 存放系统命令的目录，只有超级用户才可以执行。是 /usr/bin目录下的软连接。
- **`/usr/bin`** 存放系统命令的目录，普通用户与超级用户都可以执行。 
- **`/usr/sbin`** 存放系统命令的目录 ，只有超级用户才可以执行。
- **`/boot`** 系统启动目录，保存与系统启动相关的文件，如内核文件和启动引导程序等。 
- **`/etc`** 配置文件保存的位置，系统内采用所有默认安装方式（rpm安装）的服务配置文件全部保存在此目录中，如：用户信息、脚本文件、系统配置文件等。 
- **`/dev`** 设备文件保存的位置。
- **`/home`** 普通用户的家目录。在创建用户时，每一个用户需要有一个默认登录和保存自己数据的位置，就是用户的家目录。 
- **`/root`** root用户的家目录。
- **`/lib`** 系统调用的函数库保存位置，是/usr/lib的软连接。
- **`/lib64`** 64位函数库保存位置。是 /usr/lib64文件夹的软连接。 
- **`/media`**  通常不是使用。
- **`/opt`** 第三方软甲你保存的位置。
- **`/proc`** 保存的是内存文件。
- **`/sys`** 保存的是系统的内存、CPU信息等。
- **`/selinux`** 增强Linux安全的文件夹。

#### 2.4.2 二级目录

- **`/usr/lib`** 应用程序调用的函数库保存位置。
- **`/usr/local`** 第三方软件主要的安装目录。
- **`/usr/share`** 应用程序的资源文件保存位置，帮助文档、细节文档等。
- **`/usr/src`** 源码包存放的位置，我们手工下载的源码包和Linux内核源码包都在这里保存。
- **`/var`** 动态数据保存位置。主要保存的是缓存、日志、以及软件运行所产生的文件。
- **`/var/www/html`** RPM包安装Apache的网页的主目录。
- **`/var/log`** 系统日志保存位置。
- **`/var/spool`** 放置队列数据的目录。就是排队等待其他程序使用的数据。
- **`/var/lib`** 程序运行过程中需要调用或者改变的数据保存位置。例如：mysql的数据库存放在/var/lib/mysql中。

## 3 常用命令

### 3.1 命令基本格式

#### 3.1.1 命令提示符

```
[root@localhost ~]#
```

- []  这个是提示符的分隔符号，没有特殊的含义。
- root  表示当前的用户。
- @  表示分隔符号。
- localhost  当前系统的简写主机名，默认完整主机名（localhost.localdomain）。

- ~  代表用户当前所在的目录，此例中用户当前所在的目录是家目录。
- \#  命令提示符， \# 表示的是超级用户， $ 表示的是普通用户。

#### 3.1.2 命令基本格式

> 命令的格式： 命令 [选项] [参数]



### 3.3 基本命令

- **info ls**   查看Linux中文件类型。

- **ls -l**   查看所有文件，附带详情。
  - **ls -li**   查看详情，并显示引用链接数。
  - **ls -a**  查看所有文件，包括隐藏文件。
  - **ls -h**  显示文件所占存储空间的人性化大小。
- **echo 数据  >>  abc.txt**   将数据保存到abc.txt这个文件最后面进行保存。
- **touch  abc.txt**   文件不存在，则创建文件；文件存在，则修改这个文件的时间戳。
- **stat abc.txt**  查看文件的基本信息。
- **cat  [参数]  abc.txt**  查看文件的内容。
  - -n   显示文件的行号。
- **more bac.txt**  分页查看文件中的数据，按空格跳转到下一页，按Q退出。
- **less abc.txt**   分页查看文件中的数据，按上下键进行数据行的上下显示，按Q退出。   
- **head abc.txt**   查看这个文件的前十行。
- **tail  abc.txt**  查看文件后十行。
  - **tail -f abc.txt**  监听文件新增的内容，按 ctrl+C退出。
- **ln  /root/abc.txt  /tmp/abc.txt**   为root目录下的abc.txt文件，创建**硬链接**，链接到 tmp目录中的abc.txt。
-  **ln -s  /root/cde.txt  /tmp/cde.txt**   为root目录下的cde.txt文件，创建**软链接**，链接到 tmp目录中的cde.txt。

- **rm  [参数] abc.txt**   删除abc.txt。
  -  -f   强制删除。
  -  -i   交互删除，在删除之前会询问用户。
  -  -r  递归删除操作，可以删除目录。 

- **cp  源文件名  目标文件夹+目标文件名**  将源文件进行复制的操作，复制到目标文件夹中，如果重新指定了文件名称，则复制的新文件将以新文件名命名。
  -  -r  递归方式复制。
  -  -d  如果源文件为软链接，则复制出来的目标文件也是软链接。
  -   -i  交互复制，如果目标文件已经存在，则会询问是否覆盖。
  -  -p  复制后目标文件保留原文件的属性（包括所有者、所属组、权限、时间等）。
  -  -a  也就是 -dpr 三者的组合。

- **mv  [参数]  源文件  目标文件夹+目标文件名**   将源文件来进行剪切到对应的目标文件中，也可用于更换名称。
  -  -r  使用递归的方式进行剪切。
  -  -f  强制覆盖，如果目标文件已经存在，则不询问，直接强制覆盖。  
  -  -v  显示详细信息。

- **date**  显示当前时间。

### 3.4 链接--ln

#### 3.4.1 硬链接

​	在Linux中的硬链接主要是用于将一个文件关联上其他位置的一个文件，并且对这文件的修改都是实时同步的修改操作。**其实际的原理就是两个都指向了同一个文件**。

​	创建硬链接：

> - 命令： **`ln  源文件名  绝对路径+链接文件名`**
> - 例如： ln  /root/abc.txt  /tmp/abc.txt

​	主要特征包括：

- 源文件和硬链接文件拥有着相同的**Inode**与**Block**。
- 修改任意一个文件，另一个都在改变。
- 删除任意一个文件，另一个都能使用。
- 硬链接标记不清，很难确认硬链接文件位置。
- 硬链接不能链接目录。
- 硬链接不能够跨越分区。

#### 3.4.2 软链接

​	在Linux中的软链接，其原理是：在目标文件中创建一个软链接文件，里面存放的是源文件的Inode数据，软链接根据这个Inode查询到对应的源文件。

​	创建软链接：

> - 命令： **`ln -s 绝对路径+源文件名  绝对路径+链接文件名`**
> - 例如： **`ln -s /root/cde.txt  /tmp/cde.txt `**

​	主要特征包括：

- 软链接和源文件拥有不同的**Inode**与**Block**。
- 两个文件修改任意一个，另一个都改变。
- 删除软链接，源文件不受影响，删除源文件，软链接则不能够在使用。
- 软链接没有实际数据，只**保存源文件的Inode**，不论源文件多大，软链接大小不会改变。

- 软链接的权限最大为 lrwxrwxrwx，但是由于没有实际数据，最终访问时需要参考源文件权限。
- 软链接能够链接目录，跨越分区。
- 软链接特征明显。



## 4 Linux权限

### 4.1 文件类型

​	Linux中使用的是权限位的第一位表示文件类型。文件类型主要分为：

-  “-”  普通文件。
- “b”  块设备文件。特殊的设备文件，存储设备也是这种文件。如：文件的分区：/dev/dal
- “c”  字符设备文件。
- “d”  目录文件。Linux中的一切皆文件，所以目录也属于文件中的一种。
- “l”  软链接文件。
- “p”  管道符文件。
- “s”  套接字文件。

### 4.2 权限分类

#### 4.2.1 权限标识

```shell
drwxr-xr-x. 2 root root  4096 4月  10 02:39 mysql
```

- 第一个 字符d  表示的是目录文件。
- 第 2~~4 字符 表示的是用户user拥有的权限，使用字符  **`u`** 表示。
- 第 5~~7 字符 表示的是用户所属组group拥有的权限，使用字符  **`g`** 表示。
- 第 8~~10 字符 表示的是其他用户所拥有的权限，使用字符  **`o`** 表示。

#### 4.2.2 权限对应关系

- **`u`** ：user，对应当前用户。
- **`g`** ：group，对应当前用户组。
- **`o`** ：orther，对应其他用户。
- **`a`** ： all，对应所有的身份。

#### 4.2.3 权限设计

- **`r`** ： read的意思，表示的是具有读的权限。
- **`w`** ： write的意思，表示的是具有写的权限。
- **`x`** ： execue的意思，表示的是具有执行的权限。



### 4.3 权限命令

#### 4.3.1 基本权限命令

> 命令： chmod  [选项]  权限模式  文件名
>
> 例如：
>
> - chmod  u+x  abc.txt    针对abc.txt文件，给当前user添加 x 可执行权限。
> - chmod  u-x,g-w,o-w  abc.txt  针对abc.txt文件，给user减掉 x 执行权限，并给 group、orther减去write权限。
> - chmod  u=rwx,g=rw,o=r  abc.txt  针对文件，使用 = 进行权限赋值。

#### 4.3.2 权限赋予方式

- **` +  -`** ： 使用 + 号与 - 号进行权限的加减。
- **`=`** ： 使用 = 进行权限的赋值操作。

#### 4.3.3 数字权限

- **`4`** ： 代表 **r** 权限。
- **`2`** ： 代表 **w** 权限。
- **`1`** ： 代表 **x** 权限。

> 例如：
>
> - chmod  755  abc.txt   针对abc.txt文件，修改权限为 755.

### 4.4 用户管理

> 添加用户：  adduser  用户名
>
> 修改密码：  passwd   用户名    

### 4.5 用户组管理

> 修改文件的所属用户： chown   用户名   文件名     
>
> ​	例如： chown  user  abc.txt

> 修改文件和目录的所属组与用户：  chown   [选项]   所有者:所属组   文件或者目录
>
> ​	例如： chown  user1:test  abc.txt

### 4.6 umask

​	umask 命令是创建文件、目录时默认的权限控制。

- 对文件来将，创建文件默认的最大权限为666.因为系统为了避免创建的文件拥有可执行的权限，所以默认创建的文件的权限大小为 ：  666 - umask的值后三位。

- 对目录来讲，创建文件默认的最大权限为777.默认创建的目录的权限大小为 ：  777 - umask的后三位。

- 查看umask默认权限值：   输入命令  umask。

### 4.7 帮助命令

#### 4.7.1 man 

​	使用 man 命令能够查询命令的详细介绍。

> ​	命令： **man +  [参数] + [命令]**
>
> ​	例如： **man  ls** 

#### 4.7.2 whatis  

​	使用 whatis命令查询对应的命令详情。

> ​	命令： **whatis  +  [命令]**
>
> ​	例如： **whatis  ls**

#### 4.7.3 info

​	使用info来查询对应的命令。

> 操作info的快捷键：
>
> - 上箭头 ： 上移一行
> - pageUp：翻向上一页
> - pageDown：翻向下一页
> - u ： 进入上一层信息
> - n ： 进入下一小节
> - p ： 进入上一小节
> - q ： 退出
>
> 命令： **info  {命令]**

#### 4.7.4 help命令

​	help能够获取Shell内置命令的帮助。

#### 4.7.5 --help 命令

> 命令：  命名  +  --help

### 4.8 搜索命令

#### 4.8.1 whereis 命令

​	whereis 命令是搜索系统命令的命令，也就是说whereis命令不能够搜索普通文件，只能搜索系统命令。

​	whereis查找二进制命令的同时，查找到帮助文档的位置。

#### 4.8.2 which 命令

​	which是查找系统命令的命令，当命令存在对应的别名，则可以查找到其别名。

#### 4.8.3 locate 命令

​	使用**locate命令能够按照数据库进行搜索，只能搜素文件名**，搜索速度快，消耗资源小。搜索的数据库位置处于： /var

> 安装： 
>
> - 第一步：yum  install  mlocate  -y    安装软件
> - 第二步： updatedb     更新数据库
>
> 命令： locate  +  搜索名
>
> 例如： locate  ls

#### 4.8.4 find 命令

- **按照文件名搜索**

> 命令： find   + 搜索路径  + [选项]  搜索内容
>
> 选项：
>
> ​	-name ： 按照文件名搜索
>
> ​	-iname ： 按照文件名搜索，并且不区分大小写
>
> ​	-inum ： 按照Inode号进行搜索
>
> 例如： find  .  -name   abc.txt     按照名称查询当前路径下的abc.txt文件是否存在。

- **按照文件大小搜索**

> 命令： find  +  搜索路径  +  [选项]  +  搜索内容
>
> 选项：
>
> ​	-size  [+/-]   数据大小  ： 按照指定大小来进行搜索 
>
> ​		 +表示比指定的数据大小更大的。
>
> ​		 -表示比指定的数据大小更小的。
>
> 例如： 
>
> find . -size -28M   查询当前路径下比 28兆 更小的文件。
>
> find  .  -size  27c   查询27字节的文件。

- **按照文件修改时间**

> 简介：Linux 中的文件有访问时间（atime），数据修改时间（mtime），状态修改时间（ctime）三个时间。
>
> 命令：find  + 搜索路径  +  [选项]  +  搜索内容
>
> 选项：
>
> ​	-atime [+/-]  时间： 按照文件访问时间进行搜索。
>
> ​	-mtime [+/-]  时间： 按照文件数据修改时间搜索。
>
> ​	-ctime [+/-]  时间：按照文件状态修改时间搜索。
>
> - \- 5 表示5天内修改的文件。
> -  5 表示5-6天内修改的文件。
> -  \+ 5 表示6天前修改的文件。

- **按照权限搜索**

> 命令： find  +  [搜索路径]  +  [选项]  +  搜索内容
>
> 选项：
>
> ​	-perm  权限模式： 查找文件权限刚好等于 “权限模式” 的文件。
>
> ​	-perm  -权限模式：查找文件权限全部包含“权限模式”的文件。
>
> ​	-perm  +权限模式：查找文件权限包含“权限模式”的任意一个权限的文件。
>
> 例如：find  .  -perm  +444

- **按照所有者所属组搜索**

> 命令： find  +  搜索路径  +  [选项]  +  搜索内容
>
> 选项：
>
> ​	-uid  用户id：按照用户id查询是指定所有者id的文件。
>
> ​	-gid  组id：按照用户组id查找所属组是指定id的文件。
>
> ​	-user  用户名： 查找对用用户名的文件。
>
> ​	-group 组名 ： 查找对应组的文件。
>
> ​	-nouser ： 查找没有所有者的文件。 

- **按照文件类型搜索**

>命令： find  +  搜索路径  +  [选项]  +  搜索内容
>
>选项：
>
>​	-type  d ： 查找目录
>
>​	-type  f  ： 查找普通文件
>
>​	-type  l  ： 查找软链接文件

#### 4.8.5 find + 逻辑运算符

> 命令 ： find  +  搜索路径  +  [选项]  +  搜索内容
>
> 选项：
>
> ​	-a ： and逻辑与运算。
>
> ​	-o ： or逻辑或运算。
>
> ​	-not ： not逻辑非运算。
>
> 例如： find  .  -name  abc.txt  -o  -name  bdc.txt 

#### 4.8.6 find/ok + exec

> 命令： find/ok  +  [搜索路径]  +  [选项]  搜索内容  -exec  命令2  {}  \ 
>
> 简介： 先执行前面搜索内容的操作，将得到的结果作为参数 加入到 命令2的 {} 中。
>
> 例如： find  .  -name  abc.txt  -a  -size -28M  -exec ls  -l  {}  \ ;  查找到对应的文件，并使用ls查看详情。

### 4.9 grep命令：补充命令

​	grep 的作用是在文件中提取和匹配符合条件的字符串行。

> 命令 ： grep  +  [选项]  +  "搜索内容"  +  文件名
>
> 选项：
>
> ​	-i ： 忽略大小写。
>
> ​	-n： 输出行号。
>
> ​	-v ： 反向查找。
>
> ​	--color=auto：搜索出的关键字用颜色表示。	

​	find命令是专注于查找文件或者目录，而grep命令则是专注于匹配文件中的字符串。